<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
<title>yumemi_rin.lu • IG</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --w:1080; --h:1350;                       /* IG 4:5 畫布 */
    --grad:linear-gradient(90deg,#4DA3FF,#FF7CBC);  /* 藍→粉 */
    --heroH:520px;                             /* 頂部滿版照片高度 */
    --halo-rot: 0deg;          /* 霓虹環旋轉角度（GSAP 控） */
    --halo-bright: 1.2;        /* 亮度係數（filter:brightness） */
    --halo-sat: 2;             /* 飽和度係數（filter:saturate） */
    --halo-op: .9;             /* 霓虹不透明度 */
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:#05080c;display:flex;justify-content:center;align-items:flex-start;padding-top:0;padding-bottom:0}

  /* 1080×1350 畫布自動縮放 */
  .stage{position:relative; width:calc(var(--w)*1px); height:calc(var(--h)*1px);
         transform:scale(var(--s,1)); transform-origin:top center; border-radius:40px; overflow:hidden; isolation:isolate;}
  /* 外框柔和霓虹暈光 */
  .stage::before{ content:""; position:absolute; inset:-15px; border-radius:64px; pointer-events:none;
    /* 四周彩虹圓錐漸層 + 模糊，形成柔和光暈（更亮、更飽和） */
    background: conic-gradient(
      from var(--halo-rot, 0deg),
#52DCFF,
#FF7CBC,
#1AB8FF,
#3366ff,
#00FFD2
    );
    filter: blur(26px) saturate(var(--halo-sat)) brightness(var(--halo-bright));
    opacity: var(--halo-op);
    mix-blend-mode:screen;
    z-index:0;
  }
  .stage::after{ content:""; position:absolute; left:-20px; right:-20px; top:-6px; height:140px; border-radius:56px; pointer-events:none;
    background: linear-gradient(90deg, rgba(66,240,255,1) 0%, rgba(255,255,255,1) 48%, rgba(255,200,160,.95) 65%, rgba(255,120,90,1) 100%);
    mask: linear-gradient(#000, transparent 85%);
    filter: blur(60px) saturate(180%) brightness(1.55);
    mix-blend-mode:screen; opacity:1;
  }

  .card-wrap{ position:absolute; inset:48px; border-radius:36px; }
  /* 霓虹外光暈（不被 .card 的 overflow 隱藏） */
  .card-wrap::before{
    content:""; position:absolute; inset:-20px; border-radius:inherit; pointer-events:none;
    background: conic-gradient(
      from var(--halo-rot, 0deg),
#52DCFF,
#FF7CBC,
#1AB8FF,
#3366ff,
#00FFD2
    );
    filter: blur(34px) saturate(var(--halo-sat)) brightness(var(--halo-bright));
    opacity: var(--halo-op); mix-blend-mode:screen;
  }
  .card-wrap::after{
    content:""; position:absolute; inset:-8px; border-radius:inherit; pointer-events:none;
    background: conic-gradient(
      from var(--halo-rot, 0deg),
#52DCFF,
#FF7CBC,
#1AB8FF,
#3366ff,
#00FFD2
    );
    padding:12px; /* 亮邊厚度 */
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor; /* 只留外圍描邊 */
    mask-composite: exclude;
    filter: blur(6px) saturate(var(--halo-sat)) brightness(var(--halo-bright));
    opacity:.95; mix-blend-mode:screen;
  }

  /* 背景 */
  .bg{position:absolute; inset:0;
      background:radial-gradient(1200px 900px at 20% -10%, #142030 0, #0b1219 55%, #070b10 100%);}
  .bg::after{
    content:""; position:absolute; inset:0; pointer-events:none; mix-blend-mode:screen;
    background:radial-gradient(1200px 900px at 50% 120%, rgba(77,163,255,.18), transparent 60%),
               radial-gradient(1000px 700px at -10% 10%, rgba(255,124,188,.12), transparent 55%);
  }

  /* CLI 卡片 */
  .card{
    position:absolute; inset:0; border-radius:36px; overflow:hidden;
    background:linear-gradient(#111923,#0c1218);
    border:1px solid rgba(105,140,180,.25);
    box-shadow:0 30px 100px rgba(0,0,0,.65), inset 0 1px 0 rgba(255,255,255,.08),
               0 0 90px rgba(120,190,255,.60), 0 0 180px rgba(255,124,188,.50), 0 0 260px rgba(255,180,120,.40);
  }
  /* 掃描線 */
  .card::before{
    content:""; position:absolute; inset:0; opacity:.35; mix-blend-mode:overlay; pointer-events:none;
    background:repeating-linear-gradient(0deg,rgba(255,255,255,.04),rgba(255,255,255,.04) 1px,transparent 1px,transparent 3px);
    animation:scan 7s linear infinite;
  }
  .card::after{ content:""; position:absolute; inset:0; border-radius:36px; pointer-events:none;
    box-shadow: inset 0 0 0 2px rgba(255,255,255,.12), inset 0 0 48px rgba(160,200,255,.25), inset 0 0 90px rgba(255,160,200,.18);
    mix-blend-mode:screen; opacity:1;
  }
  @keyframes scan { 0%{opacity:.35} 50%{opacity:.5} 100%{opacity:.35} }

  /* —— 右上角斜條（商品監修中） —— */
  .ribbon{
    position:absolute; top:-64px; right:-260px; /* 讓斜條從右上角切入，超出部分會被 card 裁切 */
    width:980px; height:84px; border-radius:12px;
    transform:rotate(32deg);
    background: linear-gradient(90deg, rgba(38,162,200,.5), rgba(120,198,255,.5));
    border: 1px solid rgba(120,190,220,.35);
    box-shadow: 0 8px 18px rgba(0,140,220,.18), inset 0 1px 0 rgba(255,255,255,.25);
    backdrop-filter: blur(2px) saturate(120%);
    display:flex; align-items:center; justify-content:center;
    font-family:"Google Sans Code","Roboto Mono","Noto Sans Mono",ui-monospace, Menlo, Consolas, monospace;
    font-weight:900; font-size:42px; letter-spacing:.15em;
    color: #e6f3ff;
    text-shadow: 0 1px 4px rgba(0,0,0,.25), 0 0 8px rgba(120,190,255,.25);
    pointer-events:none; z-index:9;  /* 不遮擋操作，並壓在最上層 */
  }
  .ribbon::before, .ribbon::after{
    content:""; position:absolute; left:6%; right:6%; height:3px; border-radius:2px;
    background: linear-gradient(90deg, rgba(230,245,255,.5), rgba(120,190,240,.35));
  }
  .ribbon::before{ top:10px; }
  .ribbon::after{ bottom:10px; }

  /* 標題區（置中，兩行） */
  .header{position:absolute; left:80px; right:80px; top:548px; height:300px; z-index:2;}
  .title{
    --scale:1;
    position:absolute; left:50%; top:50%;
    transform:translate(-50%,-50%) scale(var(--scale));
    transform-origin:center;
    line-height:0.95; text-align:center; white-space:nowrap;
    font-family:"Press Start 2P", ui-monospace, monospace;
    font-size:150px; letter-spacing:.06em;
    filter:drop-shadow(0 0 18px rgba(170,140,255,.25));
  }
  .line{
    display:block; position:relative;
    background:var(--grad); background-size:200% 100%;
    -webkit-background-clip:text; background-clip:text; color:transparent;
    animation:gradientMove 10s linear infinite, flicker 6s infinite;
  }
  /* 點陣疊紋（僅字內） */
  .line::after{
    content:attr(data-text); position:absolute; inset:0; color:transparent; pointer-events:none;
    -webkit-background-clip:text; background-clip:text;
    background:radial-gradient(circle at 1px 1px, rgba(0,0,0,.55) 0 1px, transparent 1.2px) 0 0/6px 6px;
    mix-blend-mode:multiply; opacity:.6; animation:flicker 6s infinite;
  }
  /* 標題後方點陣背景 */
  .header::after{
    content:""; position:absolute; inset:0 0 30px 0; pointer-events:none; opacity:.2;
    background:radial-gradient(circle at 1px 1px, rgba(38,54,72,.7) 0 1px, transparent 1.2px) 0 0/10px 10px;
    mask:linear-gradient(#000, transparent 85%);
  }
  @keyframes gradientMove { from{background-position:0% 50%} to{background-position:100% 50%} }
  @keyframes flicker{
    0%,19%,21%,23%,25%,54%,56%,100%{opacity:1; filter:brightness(1)}
    20%,55%{opacity:.88}
    22%{opacity:.5; filter:brightness(.92)}
    73%{opacity:.45} 74%{opacity:1}
  }
  /* 照片區：full width top banner */
  .photo{ position:absolute; left:80px; right:80px; top:24px; height:auto; aspect-ratio:4 / 3;
          border-radius:24px; overflow:hidden; z-index:1; }
  .hero-photo{ position:absolute; inset:0; width:100%; height:100%; object-fit:contain; border-radius:inherit; box-shadow:none; background:#0d131a; filter:blur(0px); will-change:transform, filter; }
  .photo::after{ content:""; position:absolute; inset:0; pointer-events:none; background:linear-gradient(180deg, rgba(10,14,20,0) 0%, rgba(10,14,20,.22) 70%, rgba(10,14,20,.55) 100%); }

  /* 內文 */
  .body{position:absolute; left:80px; right:80px; bottom:72px; color:#cfe0f1;
        font-family:"Google Sans Code","Roboto Mono","Noto Sans Mono",ui-monospace, Menlo, Consolas, monospace;
        font-optical-sizing:auto; font-weight:500; z-index:2;}
  .tips{ font-size:36px; line-height:1.5; font-weight:700; color:#d6e7ff; margin-bottom:14px; }
  .list{ font-size:32px; line-height:1.7; color:#b8c8d8; }
  .list em{ color:#d2eaff; font-style:normal }
  .prompt{ margin-top:28px; color:#9fb0c3; font-size:34px; }
  .prompt::after{ content:"▌"; margin-left:8px; animation:blink 1s steps(1,end) infinite; color:#9ad1ff; }
  @keyframes blink{ 50%{opacity:0} }
  .title .small{ font-size:0.58em; letter-spacing:.08em; margin-top:.15em; }
</style>
</head>
<body>
  <div class="stage" id="stage">
    <div class="bg"></div>
    <div class="card-wrap">
      <div class="card">
      <div class="header" id="header">
        <div class="title" id="title">
        </div>
      </div>
      <div class="photo">
        <img src="rin01.jpg" alt="rin01" class="hero-photo" />
      </div>

      <div class="body">
        <div class="tips">yumemi_rin.lu's 2025 Birthday Event</div>
        <div class="tips">2025 露希凜生誕出勤 2025-09-07 (日)</div>
        <div class="list">
          <div>1. 出勤時間 15:00-22:30，都是夢見的正裝出勤！</div>
          <div>2. 活動特典：生誕當天點一張實體拍立得或一杯賞酒，或是購買第一項親簽小卡以外的生誕周邊，就送生誕限定的金屬親簽小卡一張，買二送二，以此類推，送完為止！</div>
          <div>3. <em>/點擊下一張圖片</em>，來看看有哪些生誕特殊周邊吧~</div>
        </div>
        <div class="prompt">>_ 在生誕當天 跟我說想說的話吧...</div>
      </div>
      </div>
      <div class="ribbon">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 記得要來喔</div>
    </div>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/TextPlugin.min.js"></script>
<script>
  // ===== GSAP 動畫設定 =====
  let promptEl = null, promptText = "";
  document.addEventListener('DOMContentLoaded', () => {
    promptEl = document.querySelector('.prompt');
    if (promptEl){ promptText = promptEl.textContent.trim(); promptEl.textContent = ''; }
  });

  // ===== 亂碼 → 解碼 特效（保留空白、逐步揭露） =====
  const GLYPHS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&*+-=/?:";
  const isSpace = ch => /\s/.test(ch);
  const randChar = () => GLYPHS[Math.floor(Math.random()*GLYPHS.length)];
  function scrambleToText(el, finalText, duration=3.2){
    if (!el || !finalText) return;
    const chars = Array.from(finalText);
    const out   = chars.map(ch => isSpace(ch) ? ch : randChar());
    el.textContent = out.join("");
    const state = { p:0 };
    gsap.to(state, {
      p:1, duration, ease:'power2.out',
      onUpdate(){
        const reveal = Math.floor(state.p * chars.length);
        for (let i=0;i<chars.length;i++){
          if (isSpace(chars[i]) || i < reveal) out[i] = chars[i];
          else if (Math.random() < 0.5) out[i] = randChar();
        }
        el.textContent = out.join("");
      },
      onComplete(){ el.textContent = finalText; }
    });
  }
  // 進階：保留標籤的亂碼→解碼（先用 innerText 出字、完成後還原原始 HTML）
  function scrambleRevealElement(el, duration=2.6){
    if (!el) return;
    const origHTML  = el.innerHTML;
    const finalText = el.innerText;   // 讓 <br> 轉成換行
    el.style.whiteSpace = 'pre-line';
    scrambleToText(el, finalText, duration);
    // 動畫結束後還原 HTML（延遲 duration）
    gsap.delayedCall(duration, ()=>{ el.innerHTML = origHTML; el.style.whiteSpace = ''; });
  }

function runAnimations() {
  if (typeof gsap === 'undefined') return; // 若 CDN 未載入則略過
  if (gsap.TextPlugin) gsap.registerPlugin(TextPlugin);

  const tl = gsap.timeline({ defaults:{ ease:'power3.out' } });

  // 添加緞帶淡入動畫
  tl.fromTo(".ribbon", { opacity: 0 }, { opacity: 1, duration: 3, delay: 0.6 });

  // 標題進場（兩行逐一抬升）
  tl.from('.line', { y:40, opacity:0, duration:.8, stagger:.15 }, 0)
    // 照片裁切揭露 + 微縮放 + 模糊→清晰
    .fromTo('.hero-photo', { clipPath:'inset(100% 0% 0% 0%)', scale:1.06, filter:'blur(18px)' }, { clipPath:'inset(0% 0% 0% 0%)', scale:1, filter:'blur(0px)', duration:1.2, ease:'power3.out' }, 0.35)
    // 內文漸現
    .from(['.tips', '.list > div'], { y:20, opacity:0, duration:.5, stagger:.06 }, 0.8)
    .add(()=> scrambleToText(promptEl, promptText, 3.2), 1.0)
    // 外圈霓虹：與文字同步亮起＆旋轉
    .set(document.documentElement, { '--halo-op': 0, '--halo-bright': 1.0 }, 0)
    .to(document.documentElement, { '--halo-op': .95, '--halo-bright': 1.6, duration:.8, ease:'power2.out' }, 0)
    .to(document.documentElement, { '--halo-rot': '180deg', duration:3.2, ease:'none' }, 1.0)
    .to(document.documentElement, { '--halo-bright': 1.8, duration:.4, yoyo:true, repeat:7, ease:'sine.inOut' }, 1.0);

  // 標題與照片的微浮動循環
  gsap.to('#title', { y:-6, duration:3, yoyo:true, repeat:-1, ease:'sine.inOut' });
  gsap.to('.hero-photo', { y:-3, duration:4, yoyo:true, repeat:-1, ease:'sine.inOut' });
  gsap.to(document.documentElement, { '--halo-rot': '+=360deg', duration:20, ease:'none', repeat:-1 });
}

  // 讓整個 1080×1350 畫布自動縮放以符合視窗
  function fitCanvas(){
    const w = 1080, h = 1350;
    const marginV = 10; // 上下都預留 10px
    const availW  = window.innerWidth;
    const availH  = Math.max(0, window.innerHeight - marginV*2);
    const s = Math.min(availW / w, availH / h);
    const stage = document.querySelector('.stage');
    if (!stage) return;
    stage.style.setProperty('--s', s);
    stage.style.marginTop = marginV + 'px';
    stage.style.marginBottom = marginV + 'px';
    layoutBlocks();
    scaleTitle();
    avoidOverlap();
  }

  // 版面配置：照片以 4:3 填滿文字等寬區，且不裁切；標題置於其下，留 48px 間距
  function layoutBlocks(){
    const card   = document.querySelector('.card');
    const photo  = document.querySelector('.photo');
    const header = document.getElementById('header');
    if (!card || !photo || !header) return;

    const LR = 80;              // 左右內距需與 CSS 一致
    const TOP_PHOTO = 45;       // 照片離卡片頂端距離
    const GAP = 50;             // 照片與標題的間距

    const availW = card.clientWidth - LR*2; // 內文字區寬
    const photoH = Math.round(availW * 3 / 4); // 4:3 高度

    // 套用尺寸
    photo.style.height = photoH + 'px';
    photo.style.top = TOP_PHOTO + 'px';

    // 標題頂端位置 = 照片底 + 間距
    header.style.top = (TOP_PHOTO + photoH + GAP) + 'px';
  }

  // 讓兩行標題自動塞滿 header 寬度，且不會碰到底下內文（同時考慮高度）
  function scaleTitle(){
    const header = document.getElementById('header');
    const title  = document.getElementById('title');
    const body   = document.querySelector('.body');
    if (!header || !title || !body) return;

    const lines  = [...title.querySelectorAll('.line')];

    // 先依寬度計算縮放
    title.style.setProperty('--scale', 1);
    const maxLine = Math.max(...lines.map(l => l.scrollWidth));
    const availableW = header.clientWidth - 60; // 左右安全邊距
    let s = Math.min(1.2, availableW / maxLine);
    title.style.setProperty('--scale', s.toFixed(4));

    // 再依高度檢查是否會跟內文重疊
    const cardRect   = document.querySelector('.card').getBoundingClientRect();
    const headerRect = header.getBoundingClientRect();
    const bodyRect   = body.getBoundingClientRect();
    const margin = 48; // 與內文至少 48px 的距離

    const availableH = (bodyRect.top - cardRect.top) - (headerRect.top - cardRect.top) - margin;
    const titleH = title.getBoundingClientRect().height;
    if (availableH > 0 && titleH > availableH) {
      const ratio = availableH / titleH;
      s = Math.max(0.4, s * ratio);
      title.style.setProperty('--scale', s.toFixed(4));
    }
  }

  // 確保標題不與下方內文重疊：若空間不足自動縮小，必要時微調位置
  function avoidOverlap(){
    const card   = document.querySelector('.card');
    const header = document.getElementById('header');
    const title  = document.getElementById('title');
    const body   = document.querySelector('.body');
    const photo  = document.querySelector('.photo');
    if (!card || !header || !title || !body || !photo) return;

    const cardRect = card.getBoundingClientRect();
    const bodyTop  = body.getBoundingClientRect().top - cardRect.top;
    const headerTop = parseFloat(getComputedStyle(header).top);
    const margin = 56; // 與內文至少 56px 間距

    let scale = parseFloat(getComputedStyle(title).getPropertyValue('--scale')) || 1;
    let titleH = title.getBoundingClientRect().height;
    let headerBottom = headerTop + titleH;

    if (headerBottom + margin > bodyTop){
      const availableH = bodyTop - headerTop - margin;
      if (availableH > 80){
        const ratio = (availableH / titleH) * 0.98; // 留一點緩衝
        scale = Math.max(0.45, scale * ratio);
        title.style.setProperty('--scale', scale.toFixed(4));
      } else {
        // 空間太小則把標題往上提，但不超過照片底緣 + 48
        const photoBottom = (parseFloat(getComputedStyle(photo).top) + photo.clientHeight);
        const newTop = Math.max(photoBottom + 48, bodyTop - margin - titleH);
        header.style.top = newTop + 'px';
      }
    }
  }

  addEventListener('resize', fitCanvas);
  addEventListener('load', () => {
    fitCanvas();
    if (document.fonts) {
      document.fonts.ready.then(()=>{ layoutBlocks(); scaleTitle(); avoidOverlap(); runAnimations(); });
    } else {
      layoutBlocks();
      scaleTitle();
      avoidOverlap();
      runAnimations();
    }
  });
</script>
</body>
</html>